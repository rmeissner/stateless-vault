{"version":3,"sources":["components/WalletInfo.tsx","logic/ethereumRepository.ts","logic/vaultRepository.ts","components/vault/transactions/VaultTransactions.tsx","components/vault/transactions/VaultTransactionDetails.tsx","components/vault/settings/AddVaultDialog.tsx","components/vault/settings/VaultSettings.tsx","components/vault/settings/VaultSelectionDialog.tsx","components/vault/apps/messaging.ts","logic/relayRepository.ts","components/vault/apps/TransactionProposalDialog.tsx","components/vault/apps/VaultApps.tsx","components/ConnectButton.tsx","components/vault/settings/VaultCreationDialog.tsx","components/vault/VaultHome.tsx","assets/icons/yacate-logo.svg","utils/general.ts","components/onboarding/Welcome.tsx","components/App.tsx","styles/global.ts","Root.tsx","serviceWorkerRegistraction.ts","index.tsx","components/vault/utils/multisend.ts","../../src/index.ts","../../../src/utils/signatures.ts","../../../src/utils/ipfs.ts","../../../src/utils/proof.ts","utils/config.ts"],"names":["AccountInfo","address","className","textColor","hash","textSize","showCopyBtn","showIdenticon","showEtherscanBtn","shortenHash","network","chainName","WALLET_STORAGE_KEY","WALLET_PASSWORD","localProvider","providers","JsonRpcProvider","url","rpcUrl","localSigner","undefined","loadProvider","setLocalSigner","signer","loadSigner","getSignerAddress","a","getAddress","hasAppSigner","localStorage","getItem","getAppSigner","walletState","Wallet","fromEncryptedJson","createRandom","wallet","console","log","encrypt","setItem","getAppSignerAddress","appSigner","setAppSigner","VAULTS_STORAGE_KEY","PROPOSAL_STORAGE_KEY_PREFIX","SELECTED_VAULT_STORAGE_KEY","STORAGE_IPFS_CACHE_PREFIX","ipfs","IpfsClient","host","port","protocol","loadVaultStorage","stored","holder","JSON","parse","version","Error","value","writeVaultStorage","vaults","stringify","loadLastSelectedVault","store","managesVault","removeLastSelectedVault","removeItem","setLastSelectedVault","loadVaults","Object","keys","sort","map","name","setVault","removeVault","getVaultInstance","utils","isAddress","Vault","cachedLoader","key","encoding","cached","error","pullWithKeccak","e","loadTransactionDetails","vault","vaultHash","fetchTxByHash","loadProposalStorage","vaultAddress","writeProposalStorage","loadTransactionProposals","proposals","entries","transaction","left","right","BigNumber","from","nonce","sub","toNumber","removeTransactionProposals","vaultHashes","addTransactionProposal","publishTx","to","data","operation","meta","metaHash","styles","createStyles","list","item","display","withStyles","classes","React","transactions","setTransactions","setProposals","loadItems","loadTransactions","tx","action","filter","val","listItems","ListItem","Box","textOverflow","overflow","txHash","success","location","pathname","toString","ethereumHash","proposalItems","proposal","length","List","Typography","details","flex","overflowWrap","maxWidth","justifyContent","history","useHistory","useParams","setDetails","loadDetails","goBack","WalletInfo","formatEther","minAvailableGas","remove","margin","open","onClose","vaultName","setVaultName","setVaultAddress","inputError","setInputError","addVault","cleanAddress","push","Dialog","scroll","aria-labelledby","aria-describedby","DialogTitle","id","DialogContent","dividers","DialogContentText","tabIndex","TextField","label","onChange","target","helperText","DialogActions","Button","onClick","color","content","configuration","setConfiguration","loadLocalSigner","loadConfig","threshold","signers","implementation","onAdd","onCreate","setVaults","select","init","Delete","FrameCommunicator","frame","appUrl","info","handlers","provider","method","params","requestId","this","onTransactionProposal","txs","sendResponse","txServiceUrl","payload","communicator","send","call","then","resp","err","sendError","message","source","window","includes","origin","handleMessage","frameWindow","current","contentWindow","sdkVersion","getSDKVersion","msg","MessageFormatter","makeResponse","postMessage","makeErrorResponse","defaultWindow","eventWindow","callback","ev","onMessage","addEventListener","removeEventListener","sameTx","toLowerCase","eq","checkFeeAndOptimize","estimate","fee","decodeMultiSend","transactionsWithPayment","paymentTx","feeReceiver","requestedTransactions","buildMultiSend","requestFee","preparedTx","axios","post","relayUrl","response","relayTransaction","signatures","buildExecData","execData","relayCreation","safeTxGas","app","onConfirm","onReject","submitTx","setSubmitTx","setEstimate","proposeTx","estimation","relay","vaultTx","metaTxToVaultTx","vaultSigner","VaultSigner","signTx","estimateTx","config","signerAddress","canSubmit","indexOf","rejectTx","Checkbox","checked","_e","disabled","appContainer","border","frameborder","width","height","proposalParams","setProposalParams","defaultAppUrl","appFrame","safeAddress","ethBalance","handleTransactionConfirmation","safeTxHash","handleTransactionRejection","connect","ref","src","ConnectButton","onConnect","web3Modal","Web3Modal","providerOptions","walletconnect","package","WalletConnectProvider","options","rpc","chainId","size","setSigner","createVault","factory","relayData","getBalance","vaultBalance","deploymentTxHash","getTransaction","deploymentTx","wait","estimateCreation","RelayedVaultFactory","factoryAddress","vaultImplementationAddress","creationData","setupData","saltNonce","calculateAddress","useAppAccount","web3provider","Web3Provider","getSigner","title","toolbar","background","paddingBottom","navigation","position","bottom","VaultHomeContainer","styled","main","match","useRouteMatch","active","setActive","showVaultSelection","setShowVaultSelection","showVaultCreation","setShowVaultCreation","showAddVault","setShowAddVault","instance","loadActive","AppBar","Toolbar","ArrowDropDown","Container","path","BottomNavigation","_","newValue","showLabels","BottomNavigationAction","icon","Timeline","Apps","Settings","undefinedOnError","func","OnboardingContainer","SHeading","h1","Welcome","loading","setLoading","replace","loadSelected","selectedVault","AppLogo","alt","App","GlobalStyles","createGlobalStyle","normalize","avertaFont","avertaBoldFont","Root","StrictMode","theme","Boolean","hostname","ReactDOM","render","document","getElementById","navigator","serviceWorker","ready","registration","unregister","multiSendInterface","Interface","multiSendAbi","metaTx","metaString","toHexString","removeHexPrefix","input","startsWith","slice","encodeData","dataBuffer","Buffer","solidityPack","multiSendBytes","multiSendData","encodeFunctionData","multiSendAddress","decodeFunctionData","rawData","index","parseInt","dataLength","vaultInstance","prepareEthSignSignatureForSafe","signature","chunk","process","1","4","100"],"mappings":"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","file":"static/js/main.8ffa94c0.chunk.js","sourcesContent":["import { EthHashInfo } from '@gnosis.pm/safe-react-components'\nimport { ThemeColors } from '@gnosis.pm/safe-react-components/dist/theme'\nimport React from 'react'\nimport { chainName } from 'src/utils/config'\n\nconst AccountInfo: React.FC<{ address: string, className?: string, textColor?: ThemeColors }> = ({ address, className, textColor }) => {\n  if (!address) {\n    return null\n  }\n\n  return (\n    <EthHashInfo\n      hash={address}\n      textSize=\"xl\"\n      showCopyBtn\n      showIdenticon\n      showEtherscanBtn\n      shortenHash={4}\n      textColor={textColor || \"white\"}\n      className={className || \"address\"}\n      network={chainName}\n    />\n  )\n}\n\nexport default AccountInfo\n","import { rpcUrl } from \"src/utils/config\"\nimport { Signer, providers, Wallet } from \"ethers\"\n\nconst WALLET_STORAGE_KEY = \"ethereum_repository.app_wallet\"\nconst WALLET_PASSWORD = \"THIS_SHOULD_NOT_BE_HARDCODED\"\n\nlet localProvider = new providers.JsonRpcProvider({\n    url: rpcUrl\n})\n\nlet localSigner: Signer | undefined = undefined\n\nexport const loadProvider = (): providers.JsonRpcProvider => {\n    return localProvider\n}\n\nexport const setLocalSigner = (signer: Signer) => {\n    localSigner = signer;\n}\n\nexport const clearLocalSigner = () => {\n    localSigner = undefined\n}\n\nexport const hasLocalSigner = (): boolean => {\n    return !!localSigner\n}\n\nexport const loadSigner = (): Signer | undefined => {\n    return localSigner\n}\n\nexport const getSignerAddress = async (): Promise<string | undefined> => {\n    const signer = loadSigner()\n    if (!signer) return undefined\n    return await signer.getAddress()\n}\n\nexport const hasAppSigner = (): boolean => {\n    return !!localStorage.getItem(WALLET_STORAGE_KEY)\n}\n\nconst getAppSigner = async (): Promise<Wallet> => {\n    const walletState = localStorage.getItem(WALLET_STORAGE_KEY)\n    const wallet = walletState ? await Wallet.fromEncryptedJson(walletState, WALLET_PASSWORD) : Wallet.createRandom()\n    if (!walletState) {\n        console.log(\"Created new app wallet\")\n        localStorage.setItem(WALLET_STORAGE_KEY, await wallet.encrypt(WALLET_PASSWORD))\n    }\n    return wallet\n}\n\nexport const getAppSignerAddress = async (): Promise<string | undefined> => {\n    if (!hasAppSigner()) return undefined\n    const appSigner = await getAppSigner()\n    return appSigner.address\n}\n\nexport const setAppSigner = async () => {\n    setLocalSigner(await getAppSigner())\n}\n\nexport const getAppMnemonic = async (): Promise<string | undefined> => {\n    if (!hasAppSigner()) return undefined\n    return (await getAppSigner()).mnemonic.phrase\n}\n\nexport const clearAppSigner = async (): Promise<void> => {\n    localStorage.removeItem(WALLET_STORAGE_KEY)\n}","import { pullWithKeccak, Vault, VaultTransaction } from \"@rmeissner/stateless-vault-sdk\"\nimport { loadProvider } from \"./ethereumRepository\"\nimport { utils, BigNumber } from 'ethers'\nimport IpfsClient from 'ipfs-http-client';\n\nconst VAULTS_STORAGE_KEY = \"vault_repository.vaults\"\nconst PROPOSAL_STORAGE_KEY_PREFIX = \"vault_repository.proposals.\"\nconst SELECTED_VAULT_STORAGE_KEY = \"vault_repository.selected_vault\"\nconst STORAGE_IPFS_CACHE_PREFIX = \"vault_repository.ipfs_cache.\"\n\ninterface StorageHolder<T> {\n    readonly version: number,\n    readonly value: T\n}\n\nconst ipfs = IpfsClient({\n    host: 'ipfs.infura.io',\n    port: 5001,\n    protocol: 'https'\n});\n\nconst loadVaultStorage = (): { [key: string]: string } => {\n    const stored = localStorage.getItem(VAULTS_STORAGE_KEY)\n    if (!stored) return {}\n    const holder: StorageHolder<{ [key: string]: string }> = JSON.parse(stored)\n    if (holder.version != 0) throw Error(\"Unknown storage version \" + holder.version)\n    return holder.value\n}\n\nconst writeVaultStorage = (vaults: { [key: string]: string }) => {\n    const holder: StorageHolder<{ [key: string]: string }> = {\n        version: 0,\n        value: vaults\n    }\n    localStorage.setItem(VAULTS_STORAGE_KEY, JSON.stringify(holder))\n}\n\nexport const loadLastSelectedVault = async (): Promise<string | undefined> => {\n    const store = localStorage.getItem(SELECTED_VAULT_STORAGE_KEY)\n    if (!store) return undefined\n    const holder: StorageHolder<string> = JSON.parse(store)\n    if (holder.version != 0) throw Error(\"Unknown storage version \" + holder.version)\n    return holder.value\n}\n\nexport const loadVaultName = async (address: string): Promise<string | undefined> => {\n    const vaults = await loadVaultStorage()\n    return vaults[address]\n}\n\nexport const managesVault = async (address: string): Promise<boolean> => {\n    const vaults = await loadVaultStorage()\n    return address in vaults\n}\n\nexport const removeLastSelectedVault = async () => {\n    localStorage.removeItem(SELECTED_VAULT_STORAGE_KEY)\n}\n\nexport const setLastSelectedVault = async (address: string) => {\n    const holder: StorageHolder<string> = {\n        version: 0,\n        value: address\n    }\n    localStorage.setItem(SELECTED_VAULT_STORAGE_KEY, JSON.stringify(holder))\n}\n\nexport const loadVaults = async (): Promise<{ address: string, name: string }[]> => {\n    try {\n        const vaults = loadVaultStorage()\n        return Object.keys(vaults).sort().map((address) => {\n            return {\n                address,\n                name: vaults[address]\n            }\n        })\n    } catch (e) {\n        console.log(e)\n        return []\n    }\n}\n\nexport const setVault = async (address: string, name: string): Promise<void> => {\n    const vaults = loadVaultStorage()\n    vaults[address] = name\n    writeVaultStorage(vaults)\n}\n\nexport const removeVault = async (address: string): Promise<void> => {\n    const vaults = loadVaultStorage()\n    delete vaults[address]\n    writeVaultStorage(vaults)\n}\n\nexport const getVaultInstance = async (address: string): Promise<Vault> => {\n    if (!utils.isAddress(address)) throw Error(\"Invalid Address\")\n    return new Vault(loadProvider(), address)\n}\n\nconst cachedLoader = async (key: string, encoding: string): Promise<string> => {\n    try {\n        const cached = localStorage.getItem(STORAGE_IPFS_CACHE_PREFIX + key)\n        if (cached) return cached\n    } catch (e) {\n        console.error(e)\n    }\n    const value = await pullWithKeccak(ipfs, key, encoding)\n    try {\n        localStorage.setItem(STORAGE_IPFS_CACHE_PREFIX + key, value)\n    } catch (e) {\n        console.error(e)\n    }\n    return value\n}\n\nexport const loadTransactionDetails = async (vault: Vault, vaultHash: string): Promise<VaultTransaction> => {\n    return await vault.fetchTxByHash(ipfs, vaultHash, cachedLoader)\n}\n\nconst loadProposalStorage = (vaultAddress: string): { [key: string]: VaultTransaction } => {\n    const stored = localStorage.getItem(PROPOSAL_STORAGE_KEY_PREFIX + vaultAddress)\n    if (!stored) return {}\n    const holder: StorageHolder<{ [key: string]: VaultTransaction }> = JSON.parse(stored)\n    if (holder.version != 0) throw Error(\"Unknown storage version \" + holder.version)\n    return holder.value\n}\n\nconst writeProposalStorage = (vaultAddress: string, vaults: { [key: string]: VaultTransaction }) => {\n    const holder: StorageHolder<{ [key: string]: VaultTransaction }> = {\n        version: 0,\n        value: vaults\n    }\n    localStorage.setItem(PROPOSAL_STORAGE_KEY_PREFIX + vaultAddress, JSON.stringify(holder))\n}\n\nexport const loadTransactionProposals = async (vault: Vault): Promise<{ vaultHash: string, transaction: VaultTransaction }[]> => {\n    const proposals = loadProposalStorage(vault.address)\n    return Object.entries(proposals)\n        .map(([vaultHash, transaction]) => { return { vaultHash, transaction } })\n        .sort((left, right) => BigNumber.from(left.transaction.nonce).sub(BigNumber.from(right.transaction.nonce)).toNumber())\n}\n\nexport const removeTransactionProposals = async (vault: Vault, vaultHashes: string[]): Promise<void> => {\n    const proposals = loadProposalStorage(vault.address)\n    for (let vaultHash of vaultHashes) {\n        delete proposals[vaultHash]\n    }\n    writeProposalStorage(vault.address, proposals)\n}\n\nexport const addTransactionProposal = async (vault: Vault, transaction: VaultTransaction): Promise<string> => {\n    console.log(ipfs)\n    const { vaultHash, metaHash } = await vault.publishTx(\n        ipfs,\n        transaction.to,\n        BigNumber.from(transaction.value),\n        transaction.data,\n        transaction.operation,\n        BigNumber.from(transaction.nonce),\n        transaction.meta\n    )\n    transaction.metaHash = metaHash\n    const proposals = loadProposalStorage(vault.address)\n    proposals[vaultHash] = transaction\n    writeProposalStorage(vault.address, proposals)\n    return vaultHash\n}","import * as React from 'react'\nimport { Vault, VaultAction, VaultTransaction } from '@rmeissner/stateless-vault-sdk';\nimport { createStyles, WithStyles, withStyles, Box, List, ListItem, Typography } from '@material-ui/core';\nimport { Link } from 'react-router-dom';\nimport { loadTransactionProposals, removeTransactionProposals } from 'src/logic/vaultRepository';\n\nconst styles = createStyles({\n    list: {\n    },\n    item: {\n        display: 'block'\n    }\n})\n\ninterface Props extends WithStyles<typeof styles> {\n    vault: Vault\n}\n\nconst VaultTransactions: React.FC<Props> = ({ vault, classes }) => {\n    const [transactions, setTransactions] = React.useState<VaultAction[]>([])\n    const [proposals, setProposals] = React.useState<{vaultHash: string, transaction: VaultTransaction}[]>([])\n    const loadItems = React.useCallback(async () => {\n        try {\n            const transactions = await vault.loadTransactions()\n            await removeTransactionProposals(\n                vault, transactions.map((tx) => (tx.action === \"executed_transaction\") ? tx.vaultHash : \"\").filter((val) => val !== \"\")\n            )\n            setProposals(await loadTransactionProposals(vault))\n            setTransactions(transactions)\n        } catch (e) {\n            console.log(`Could not load transactions`)\n            console.error(e)\n        }\n    }, [vault, setTransactions, setProposals])\n    React.useEffect(() => {\n        setProposals([])\n        setTransactions([])\n        loadItems()\n    }, [vault.address])\n    const listItems = transactions.map((tx) => {\n        switch (tx.action) {\n            case \"config_update\":\n                return (<ListItem className={classes.item}>\n                    <Box>Config Update</Box>\n                    <Box textOverflow=\"ellipsis\" overflow=\"hidden\">{tx.txHash}</Box>\n                </ListItem>);\n            case \"executed_transaction\":\n                if (tx.success) {\n                    return (<Link to={location => `${location.pathname}/${tx.vaultHash}`}>\n                        <ListItem className={classes.item}>\n                            <Box>Tx success (nonce {tx.nonce.toString()})</Box>\n                            <Box textOverflow=\"ellipsis\" overflow=\"hidden\">{tx.ethereumHash}</Box>\n                        </ListItem>\n                    </Link>);\n                } else {\n                    return (<Link to={location => `${location.pathname}/${tx.vaultHash}`}>\n                        <ListItem className={classes.item}>\n                            <Box>Tx failure (nonce {tx.nonce.toString()})</Box>\n                            <Box textOverflow=\"ellipsis\" overflow=\"hidden\">{tx.ethereumHash}</Box>\n                        </ListItem>\n                    </Link >);\n                }\n        }\n    })\n    const proposalItems = proposals.map((proposal) => (\n        <Link to={location => `${location.pathname}/${proposal.vaultHash}`}>\n            <ListItem className={classes.item}><Box>Tx propsal (nonce {proposal.transaction.nonce})</Box></ListItem>\n        </Link>\n    ))\n    console.log({proposalItems})\n    return (proposalItems.length + transactions.length) > 0 ? (\n        <List className={classes.list}>\n            {\n                proposalItems.length > 0 && (\n                    <>\n                        <ListItem className={classes.item}><Typography>Proposals</Typography></ListItem>\n                        { proposalItems}\n                    </>\n                )\n            }\n            {\n                listItems.length > 0 && (\n                    <>\n                        <ListItem className={classes.item}><Typography>History</Typography></ListItem>\n                        { listItems}\n                    </>\n                )\n            }\n        </List>\n    ) : (\n            <p>No Transactions yet</p>\n        )\n}\n\nexport default withStyles(styles)(VaultTransactions)","import * as React from 'react'\nimport { Vault, VaultTransaction } from '@rmeissner/stateless-vault-sdk';\nimport { useHistory, useParams } from \"react-router-dom\";\nimport WalletInfo from '../../WalletInfo'\nimport { createStyles, WithStyles, withStyles, Box, Typography } from '@material-ui/core';\nimport { loadTransactionDetails } from 'src/logic/vaultRepository';\nimport { utils } from 'ethers';\n\nconst styles = createStyles({\n    details: {\n        flex: 1\n    },\n    data: {\n        overflowWrap: 'anywhere',\n        maxWidth: '100vw'\n    },\n    address: {\n        display: 'flex',\n        justifyContent: 'center',\n        maxWidth: '100vw'\n    }\n})\n\ninterface Props extends WithStyles<typeof styles> {\n    vault: Vault\n}\n\ninterface Path {\n    vaultHash: string\n}\n\nconst VaultTransactionDetails: React.FC<Props> = ({ vault, classes }) => {\n    console.log(\"Load Transaction\")\n    const history = useHistory()\n    const { vaultHash } = useParams<Path>()\n    console.log(useParams<any>())\n    const [details, setDetails] = React.useState<VaultTransaction | undefined>(undefined)\n    const loadDetails = React.useCallback(async () => {\n        try {\n            setDetails(await loadTransactionDetails(vault, vaultHash))\n        } catch (e) {\n            console.log(`Could not load transactions`)\n            console.error(e)\n            history.goBack()\n        }\n    }, [vault, vaultHash, setDetails])\n    console.log({ vaultHash })\n    React.useEffect(() => {\n        loadDetails()\n    }, [])\n    return details ? (\n        <Box className={classes.details}>\n            <p>Nonce</p>\n            <Typography>{details.nonce}</Typography>\n            <p>To</p>\n            <Box className={classes.address}><WalletInfo address={details.to} textColor=\"text\" /></Box>\n            <p>Value</p>\n            <Typography>{utils.formatEther(details.value)} ETH</Typography>\n            <p>Data</p>\n            <Typography className={classes.data}>{details.data}</Typography>\n            <p>Meta</p>\n            <Typography className={classes.data}>{details.meta}</Typography>\n            <p>Operation</p>\n            <Typography>{details.operation}</Typography>\n            <p>Min available gas</p>\n            <Typography>{details.minAvailableGas}</Typography>\n        </Box>\n    ) : (\n            <p>Loading details</p>\n        )\n}\n\nexport default withStyles(styles)(VaultTransactionDetails)","import * as React from 'react'\nimport { Button, createStyles, WithStyles, withStyles, TextField, Dialog, DialogContent, DialogTitle, DialogContentText, DialogActions } from '@material-ui/core'\nimport { useHistory } from 'react-router'\nimport { setVault, setLastSelectedVault, managesVault } from 'src/logic/vaultRepository'\nimport { utils } from 'ethers'\n\nconst styles = createStyles({\n    remove: {\n        margin: '16px'\n    },\n    item: {\n        flex: 1\n    }\n})\n\ninterface Props extends WithStyles<typeof styles> {\n    open: boolean,\n    onClose: () => void\n}\n\nconst AddVaultDialog: React.FC<Props> = ({ open, onClose }) => {\n    const history = useHistory()\n    const [vaultName, setVaultName] = React.useState(\"\")\n    const [vaultAddress, setVaultAddress] = React.useState(\"\")\n    const [inputError, setInputError] = React.useState<string | undefined>()\n    const addVault = React.useCallback(async () => {\n        try {\n            const cleanAddress = utils.getAddress(vaultAddress)\n            if (await managesVault(cleanAddress)) {\n                setInputError(\"Vault already exists in app\")\n                return\n            }\n            await setVault(cleanAddress, vaultName)\n            await setLastSelectedVault(cleanAddress)\n            onClose()\n            history.push(`/`)\n        } catch (e) {\n            console.error(e)\n            setInputError(\"Invalid vault address\")\n        }\n    }, [setInputError, vaultAddress, vaultName, history])\n    return (\n        <Dialog\n            open={open}\n            onClose={onClose}\n            scroll=\"paper\"\n            aria-labelledby=\"scroll-dialog-title\"\n            aria-describedby=\"scroll-dialog-description\">\n            <DialogTitle id=\"scroll-dialog-title\">Add a Vault</DialogTitle>\n            <DialogContent dividers={true}>\n                <DialogContentText\n                    id=\"scroll-dialog-description\"\n                    tabIndex={-1}\n                >\n                    <TextField\n                        label=\"Vault name\"\n                        onChange={(e) => {\n                            setVaultName(e.target.value)\n                        }}>\n                        {vaultName}\n                    </TextField>\n                    <TextField\n                        label=\"Vault address\"\n                        onChange={(e) => {\n                            setVaultAddress(e.target.value)\n                            setInputError(undefined)\n                        }}\n                        error={inputError !== undefined}\n                        helperText={inputError}>\n                        {vaultAddress}\n                    </TextField>\n                </DialogContentText>\n            </DialogContent>\n            <DialogActions>\n                <Button onClick={onClose} color=\"default\">\n                    Cancel\n                </Button>\n                <Button onClick={addVault} color=\"primary\">\n                    Add\n                </Button>\n            </DialogActions>\n        </Dialog>\n    )\n}\n\nexport default withStyles(styles)(AddVaultDialog)","import * as React from 'react'\nimport { Vault, VaultConfig } from '@rmeissner/stateless-vault-sdk'\nimport { Box, createStyles, WithStyles, withStyles, List, ListItem } from '@material-ui/core'\nimport WalletInfo from '../../WalletInfo'\nimport { getAppSignerAddress } from 'src/logic/ethereumRepository'\n\nconst styles = createStyles({\n    list: {\n    },\n    content: {\n    },\n    item: {\n        display: 'flex',\n        justifyContent: 'center',\n        maxWidth: '100vw'\n    }\n})\n\ninterface Props extends WithStyles<typeof styles> {\n    vault: Vault\n}\n\nconst VaultSettings: React.FC<Props> = ({ vault, classes }) => {\n    const [localSigner, setLocalSigner] = React.useState<string | undefined>(undefined)\n    const [configuration, setConfiguration] = React.useState<VaultConfig | undefined>(undefined)\n    const loadLocalSigner = React.useCallback(async () => {\n        try {\n            setLocalSigner(await getAppSignerAddress())\n        } catch (e) {\n            console.log(`Could not load transactions`)\n            console.error(e)\n        }\n    }, [setLocalSigner])\n    const loadConfig = React.useCallback(async () => {\n        try {\n            setConfiguration(await vault.loadConfig())\n        } catch (e) {\n            console.log(`Could not load transactions`)\n            console.error(e)\n        }\n    }, [vault, setConfiguration])\n    React.useEffect(() => {\n        loadLocalSigner()\n        loadConfig()\n    }, [])\n    return configuration ? (\n        <div className={classes.content}>\n            { localSigner && (\n                <>\n                    <p>Local Signer</p>\n                    <Box>{localSigner}</Box>\n                </>\n            )}\n            <p>Threshold</p>\n            <Box>{configuration.threshold.toString()}</Box>\n            <p>Nonce</p>\n            <Box>{configuration.nonce.toString()}</Box>\n            <p>Signers</p>\n            <List className={classes.list}>\n                {configuration.signers.map((signer) => {\n                    return (\n                        <ListItem className={classes.item}><WalletInfo address={signer} textColor=\"text\" /></ListItem>\n                    )\n                })}\n            </List>\n            <p>Implementation</p>\n            <Box className={classes.item}><WalletInfo address={configuration.implementation} textColor=\"text\" /></Box>\n        </div>\n    ) : (\n            <p>Loading config</p>\n        )\n}\n\nexport default withStyles(styles)(VaultSettings)","import * as React from 'react'\nimport { Box, Button, createStyles, WithStyles, withStyles, List, ListItem, Dialog, DialogContent, DialogTitle, DialogContentText, DialogActions } from '@material-ui/core'\nimport { useHistory } from 'react-router'\nimport { loadLastSelectedVault, loadVaults, removeVault, removeLastSelectedVault, setLastSelectedVault } from 'src/logic/vaultRepository'\nimport AccountInfo from 'src/components/WalletInfo'\nimport { Delete } from '@material-ui/icons';\n\nconst styles = createStyles({\n    remove: {\n        margin: '16px'\n    },\n    item: {\n        flex: 1\n    }\n})\n\ninterface Props extends WithStyles<typeof styles> {\n    open: boolean,\n    onClose: () => void\n    onAdd?: () => void\n    onCreate?: () => void\n}\n\nconst VaultSelectionDialog: React.FC<Props> = ({ classes, open, onClose, onAdd, onCreate }) => {\n    const history = useHistory()\n    const [vaults, setVaults] = React.useState<{ address: string, name: string }[]>([])\n    const select = React.useCallback(async (address: string) => {\n        try {\n            await setLastSelectedVault(address)\n            history.push('/')\n        } catch (e) {\n            console.error(e)\n        }\n    }, [history])\n    const remove = React.useCallback(async (address: string) => {\n        try {\n            const lastVault = await loadLastSelectedVault()\n            if (lastVault === address) {\n                await removeLastSelectedVault()\n            }\n            await removeVault(address)\n            history.push('/')\n        } catch (e) {\n            console.error(e)\n        }\n    }, [history])\n    React.useEffect(() => {\n        console.log(\"init\")\n        const init = async () => {\n            try {\n                setVaults(await loadVaults())\n            } catch (e) {\n                onClose()\n            }\n        }\n        init()\n    }, [open])\n    return (\n        <Dialog\n            open={open}\n            onClose={onClose}\n            scroll=\"paper\"\n            aria-labelledby=\"scroll-dialog-title\"\n            aria-describedby=\"scroll-dialog-description\">\n            <DialogTitle id=\"scroll-dialog-title\">Select a Vault</DialogTitle>\n            <DialogContent dividers={true}>\n                <DialogContentText\n                    id=\"scroll-dialog-description\"\n                    tabIndex={-1}\n                >\n                    <List>\n                        {vaults.map((vault) => (\n                            <ListItem onClick={() => select(vault.address)}>\n                                <Box className={classes.item}>\n                                    {vault.name}\n                                    <AccountInfo address={vault.address} textColor=\"text\" />\n                                </Box>\n                                <Button className={classes.remove} color=\"secondary\" onClick={() => remove(vault.address)}><Delete color=\"secondary\" /></Button>\n                            </ListItem>\n                        ))}\n                        {onAdd && (\n                            <ListItem>\n                                <Button onClick={() => { onAdd(); onClose() }} color=\"default\">Add vault</Button>\n                            </ListItem>\n                        )}\n                        {onCreate && (\n                            <ListItem>\n                                <Button onClick={() => { onCreate(); onClose() }} color=\"default\">Create vault</Button>\n                            </ListItem>\n                        )}\n                    </List>\n                </DialogContentText>\n            </DialogContent>\n            <DialogActions>\n                <Button onClick={onClose} color=\"primary\">\n                    Cancel\n                </Button>\n            </DialogActions>\n        </Dialog>\n    )\n}\n\nexport default withStyles(styles)(VaultSelectionDialog)","import {\n    getSDKVersion,\n    SDKMessageEvent,\n    MethodToResponse,\n    Methods,\n    SafeInfo,\n    MessageFormatter,\n    RequestId,\n    Transaction,\n    RPCPayload\n} from '@gnosis.pm/safe-apps-sdk'\nimport {\n    providers\n} from 'ethers'\n\nexport interface MessageHandlers {\n    onTransactionProposal: (transactions: Transaction[], requestId: RequestId) => void\n}\n\nexport class FrameCommunicator {\n    constructor(\n        readonly frame: React.RefObject<HTMLIFrameElement>,\n        readonly appUrl: string,\n        readonly info: SafeInfo,\n        readonly handlers: MessageHandlers,\n        readonly provider: providers.JsonRpcProvider\n    ) { }\n\n    handleMessage(\n        method: Methods,\n        params: unknown,\n        requestId: RequestId\n    ) {\n        if (!method) {\n            console.error('ThirdPartyApp: A message was received without message id.')\n            return\n        }\n        console.log(`Received ${method} with ${JSON.stringify(params)}`)\n\n        switch (method) {\n            case 'sendTransactions': {\n                if (params) {\n                    this.handlers.onTransactionProposal(\n                        // @ts-expect-error explore ways to fix this\n                        params.txs as Transaction[],\n                        requestId,\n                    )\n                }\n                break\n            }\n\n            case 'getEnvInfo': {\n                this.sendResponse({ txServiceUrl: \"\" }, requestId)\n                break\n            }\n\n            case 'getSafeInfo': {\n                this.sendResponse(this.info, requestId)\n                break\n            }\n\n            case 'rpcCall': {\n                const payload = params as RPCPayload\n                const communicator = this\n                try {\n                    this.provider.send(payload.call, payload.params).then(\n                        (resp: any) => {\n                            communicator.sendResponse(resp, requestId)\n                        }, (err: any) => {\n                            communicator.sendError(err, requestId)\n                        }\n                    )\n                } catch (err) {\n                    communicator.sendError(err, requestId)\n                }\n                break\n            }\n\n            default: {\n                console.error(`ThirdPartyApp: A message was received with an unknown method ${method}.`)\n                this.sendError(`Unknown method ${method}.`, requestId)\n                break\n            }\n        }\n    }\n\n    onMessage(message: SDKMessageEvent) {\n        if (message.source === window) {\n            return\n        }\n        if (!this.appUrl.includes(message.origin)) {\n            console.error(`ThirdPartyApp: A message was received from an unknown origin ${message.origin}`)\n            return\n        }\n        this.handleMessage(message.data.method, message.data.params, message.data.id)\n    }\n\n    sendResponse(\n        data: MethodToResponse[Methods],\n        requestId: RequestId\n    ) {\n        const frameWindow = this.frame.current?.contentWindow\n        if (!frameWindow) return\n        const sdkVersion = getSDKVersion()\n        const msg = MessageFormatter.makeResponse(requestId, data, sdkVersion)\n        frameWindow.postMessage(msg, this.appUrl)\n    }\n\n    sendError(\n        error: string,\n        requestId: RequestId\n    ) {\n        const frameWindow = this.frame.current?.contentWindow\n        if (!frameWindow) return\n        const sdkVersion = getSDKVersion()\n        const msg = MessageFormatter.makeErrorResponse(requestId, error, sdkVersion)\n        frameWindow.postMessage(msg, this.appUrl)\n    }\n\n    connect(defaultWindow?: Window): (() => void) | undefined {\n        const eventWindow = defaultWindow || this.frame.current?.contentWindow\n        if (!eventWindow) return\n        const callback = (ev: MessageEvent<any>) => { this.onMessage(ev) }\n        eventWindow.addEventListener('message', callback)\n        return () => {\n            eventWindow.removeEventListener('message', callback)\n        }\n    }\n}","import { RelayDeployment } from '@rmeissner/stateless-vault-sdk'\nimport { Vault, VaultTransaction } from '@rmeissner/stateless-vault-sdk'\nimport axios from 'axios'\nimport { BigNumber } from 'ethers'\nimport { buildMultiSend, decodeMultiSend } from 'src/components/vault/utils/multisend'\nimport { relayUrl } from 'src/utils/config'\n\nexport interface MetaTransaction {\n    to: string,\n    value: string,\n    data: string,\n    operation?: number\n}\n\nexport interface RelayEstimation {\n    fee: string,\n    feeReceiver: string,\n    transaction: MetaTransaction\n}\n\nconst sameTx = (left: MetaTransaction, right: MetaTransaction): boolean => {\n    if ((left.operation || 0) != (right.operation || 0)) return false\n    if (left.to.toLowerCase() !== right.to.toLowerCase()) return false\n    if (!BigNumber.from(left.value).eq(BigNumber.from(right.value))) return false\n    if (left.data.toLowerCase() !== right.data.toLowerCase()) return false\n    return true\n}\n\nexport const decodeAndCheckFee = async (estimate: RelayEstimation): Promise<MetaTransaction[]> => {\n    const transactions = await decodeMultiSend(estimate.transaction)\n    if (!BigNumber.from(estimate.fee).eq(BigNumber.from(0))) {\n        if (transactions.length < 2) throw Error(\"Unknown payment logic\")\n        const paymentTx = transactions[-1]\n        if (paymentTx.operation != 0) throw Error(\"Invalid payment tx operation\")\n        if (paymentTx.to.toLowerCase() != estimate.feeReceiver.toLowerCase()) throw Error(\"Invalid payment tx to\")\n        if (paymentTx.data != \"0x\") throw Error(\"Invalid payment tx data\")\n        if (!BigNumber.from(paymentTx.value).eq(BigNumber.from(estimate.fee))) throw Error(\"Invalid payment tx value\")\n    }\n    return transactions\n}\n\nconst checkFeeAndOptimize = async (tx: MetaTransaction, estimate: RelayEstimation): Promise<RelayEstimation> => {\n    if (BigNumber.from(estimate.fee).eq(BigNumber.from(0))) {\n        if (!sameTx(tx, estimate.transaction)) throw Error(\"Requested tx has been adjusted\")\n        return estimate\n    }\n    // If there is a fee we expect a multisig transaction\n    const transactionsWithPayment = await decodeMultiSend(estimate.transaction)\n    if (transactionsWithPayment.length != 2) throw Error(\"Unknown payment logic\")\n    if (!sameTx(tx, transactionsWithPayment[0])) throw Error(\"Requested tx has been adjusted\")\n    const paymentTx = transactionsWithPayment[1]\n    if (paymentTx.operation != 0) throw Error(\"Invalid payment tx operation\")\n    if (paymentTx.to.toLowerCase() != estimate.feeReceiver.toLowerCase()) throw Error(\"Invalid payment tx to\")\n    if (paymentTx.data != \"0x\") throw Error(\"Invalid payment tx data\")\n    if (!BigNumber.from(paymentTx.value).eq(BigNumber.from(estimate.fee))) throw Error(\"Invalid payment tx value\")\n    const requestedTransactions = await decodeMultiSend(tx)\n    return {\n        fee: estimate.fee,\n        feeReceiver: estimate.feeReceiver,\n        transaction: await buildMultiSend([...requestedTransactions, paymentTx])\n    }\n}\n\nexport const requestFee = async (tx: MetaTransaction): Promise<RelayEstimation> => {\n    const preparedTx = {\n        operation: 0,\n        ...tx\n    }\n    const response = await axios.post(`${relayUrl}/v1/transactions/prepare`, preparedTx)\n    return await checkFeeAndOptimize(preparedTx, response.data as RelayEstimation)\n}\n\nexport const relayTransaction = async (vault: Vault, transaction: VaultTransaction, signatures: string[]): Promise<string> => {\n    const execData = await vault.buildExecData(transaction, signatures)\n    const response = await axios.post(`${relayUrl}/v1/transactions/execute/vault`, execData)\n    return response.data\n}\n\nexport const relayCreation = async (data: RelayDeployment): Promise<string> => {\n    const transaction = {\n        safeTxGas: \"0x00\",\n        ...data.transaction\n    }\n    const response = await axios.post(`${relayUrl}/v1/deployment/execute`, {\n        ...data,\n        transaction\n    })\n    return response.data\n}","import * as React from 'react'\nimport { Vault, VaultSigner } from '@rmeissner/stateless-vault-sdk';\nimport { Box, Button, Checkbox, Typography, createStyles, withStyles, WithStyles, List, ListItem, Dialog, DialogContent, DialogTitle, DialogActions } from '@material-ui/core'\nimport { RequestId, Transaction } from '@gnosis.pm/safe-apps-sdk'\nimport AccountInfo from 'src/components/WalletInfo';\nimport { utils, BigNumber } from 'ethers';\nimport { buildMultiSend, metaTxToVaultTx } from '../utils/multisend';\nimport { RelayEstimation, relayTransaction, requestFee } from 'src/logic/relayRepository';\nimport { addTransactionProposal } from 'src/logic/vaultRepository';\nimport { relayUrl } from 'src/utils/config';\nimport { getSignerAddress, loadSigner, hasAppSigner, setAppSigner } from 'src/logic/ethereumRepository';\n\nconst styles = createStyles({\n    item: {\n        display: 'block'\n    }\n})\n\ninterface Props extends WithStyles<typeof styles> {\n    open: boolean,\n    vault: Vault,\n    transactions: Transaction[],\n    requestId: RequestId,\n    app?: string,\n    onConfirm: (requestId: RequestId, vaultHash: string) => void,\n    onReject: (requestId: RequestId, message: string) => void\n}\n\ninterface Estimate {\n    canSubmit: boolean,\n    nonce: BigNumber,\n    estimation: RelayEstimation\n}\n\nconst TransactionProposalDialog: React.FC<Props> = ({ classes, open, vault, transactions, requestId, app, onConfirm, onReject }) => {\n    const [submitTx, setSubmitTx] = React.useState(true)\n    const [estimate, setEstimate] = React.useState<Estimate | undefined>(undefined)\n    const proposeTx = React.useCallback(async () => {\n        if (!estimate) return\n        try {\n            const meta = {\n                app: app,\n                fee: estimate.estimation.fee,\n                feeReceiver: estimate.estimation.feeReceiver,\n                relay: relayUrl\n            }\n            const vaultTx = metaTxToVaultTx(estimate.estimation.transaction, estimate.nonce, meta)\n            const vaultHash = await addTransactionProposal(vault, vaultTx)\n            const signer = loadSigner()\n            if (submitTx && signer) {\n                const vaultSigner = new VaultSigner(vault, signer)\n                // Lets not wait\n                relayTransaction(vault, vaultTx, [await vaultSigner.signTx(vaultTx)]).then(\n                    (resp) => {\n                        console.log(resp)\n                    }, (error) => {\n                        console.error(error)\n                    }\n                )\n            }\n            onConfirm(requestId, vaultHash)\n        } catch (e) {\n            console.error(e)\n        }\n    }, [vault, app, requestId, estimate, submitTx, onConfirm])\n    const estimateTx = React.useCallback(async () => {\n        try {\n            const config = await vault.loadConfig()\n            const signerAddress = await getSignerAddress()\n            if (!signerAddress && hasAppSigner()) {\n                await setAppSigner()\n            }\n            const canSubmit = config.threshold.eq(BigNumber.from(1)) && !!signerAddress && config.signers.indexOf(signerAddress) >= 0\n            const transaction = await buildMultiSend(transactions)\n            const estimation = await requestFee(transaction)\n            setEstimate({\n                canSubmit,\n                estimation,\n                nonce: config.nonce\n            })\n        } catch (e) {\n            console.error(e)\n        }\n    }, [vault, transactions])\n    React.useEffect(() => {\n        estimateTx()\n    }, [estimateTx])\n    const rejectTx = React.useCallback(async () => {\n        onReject(requestId, \"User rejected transaction\")\n    }, [requestId, onReject])\n    return (\n        <Dialog\n            open={open}\n            onClose={rejectTx}\n            scroll=\"paper\"\n            aria-labelledby=\"scroll-dialog-title\"\n            aria-describedby=\"scroll-dialog-description\">\n            <DialogTitle id=\"scroll-dialog-title\">Confirm Transaction</DialogTitle>\n            <DialogContent dividers={true}>\n                <List>\n                    {transactions.map((transaction) => (\n                        <ListItem className={classes.item}>\n                            <Box><AccountInfo address={transaction.to} textColor=\"text\" /></Box>\n                            <Typography>{utils.formatEther(transaction.value)} ETH</Typography>\n                            <Box textOverflow=\"ellipsis\" overflow=\"hidden\">{transaction.data}</Box>\n                        </ListItem>\n                    ))}\n                </List>\n            </DialogContent>\n            { estimate?.canSubmit && (\n                <Box>\n                    Submit transaction via Relay for {utils.formatEther(estimate.estimation.fee)} ETH\n                    <Checkbox checked={submitTx} onChange={(_e, checked) => setSubmitTx(checked)} />\n                </Box>\n            )\n            }\n            <DialogActions>\n                <Button onClick={rejectTx} color=\"default\">\n                    Cancel\n                </Button>\n                <Button onClick={proposeTx} color=\"primary\" disabled={!estimate || !estimate.canSubmit}>\n                    Confirm\n                </Button>\n            </DialogActions>\n        </Dialog>\n    )\n}\n\nexport default withStyles(styles)(TransactionProposalDialog)","import * as React from 'react'\nimport { Vault } from '@rmeissner/stateless-vault-sdk';\nimport { createStyles, WithStyles, withStyles } from '@material-ui/core';\nimport { FrameCommunicator } from './messaging';\nimport { chainName, defaultAppUrl } from 'src/utils/config';\nimport TransactionProposalDialog from './TransactionProposalDialog';\nimport {\n    LowercaseNetworks,\n    RequestId,\n    Transaction\n} from '@gnosis.pm/safe-apps-sdk'\nimport { loadProvider } from 'src/logic/ethereumRepository';\n\nconst styles = createStyles({\n    appContainer: {\n        border: 0,\n        frameborder: 0,\n        width: '100%',\n        height: '100%'\n    }\n})\n\ninterface Props extends WithStyles<typeof styles> {\n    vault: Vault\n}\n\ninterface ProposalParams {\n    transactions: Transaction[]\n    requestId: RequestId\n}\n\nconst VaultApps: React.FC<Props> = ({ vault, classes }) => {\n    const [proposalParams, setProposalParams] = React.useState<ProposalParams | undefined>(undefined)\n    const appUrl = defaultAppUrl\n    const appFrame = React.useRef<HTMLIFrameElement>(null)\n    const communicator: FrameCommunicator = React.useMemo(() => {\n        return new FrameCommunicator(appFrame, appUrl, {\n            safeAddress: vault.address,\n            network: chainName as LowercaseNetworks,\n            ethBalance: \"0\",\n        }, {\n            onTransactionProposal: (transactions, requestId) => {\n                if (transactions.length == 0) return\n                setProposalParams({ transactions, requestId })\n            }\n        }, loadProvider())\n    }, [vault, appFrame, appUrl, setProposalParams])\n\n    const handleTransactionConfirmation = React.useCallback(async (requestId: RequestId, vaultHash: string) => {\n        communicator.sendResponse({ safeTxHash: vaultHash }, requestId)\n        setProposalParams(undefined)\n    }, [communicator, setProposalParams])\n\n    const handleTransactionRejection = React.useCallback(async (requestId: RequestId, message: string) => {\n        communicator.sendError(message, requestId)\n        setProposalParams(undefined)\n    }, [communicator, setProposalParams])\n\n    React.useEffect(() => {\n        return communicator.connect(window)\n    }, [communicator])\n\n    return (\n        <>\n            <iframe ref={appFrame} src={appUrl} className={classes.appContainer} />\n            { proposalParams && (<TransactionProposalDialog\n                open={true}\n                vault={vault}\n                app={appUrl}\n                transactions={proposalParams.transactions}\n                requestId={proposalParams.requestId}\n                onReject={handleTransactionRejection}\n                onConfirm={handleTransactionConfirmation} />\n            )}\n        </>\n    )\n}\n\nexport default withStyles(styles)(VaultApps)","import { Button } from '@gnosis.pm/safe-react-components'\nimport * as React from 'react'\nimport Web3Modal from 'web3modal'\nimport WalletConnectProvider from \"@walletconnect/web3-provider\";\nimport { chainId, rpcUrl } from 'src/utils/config';\n\ntype Props = {\n  onConnect: Function\n}\n\nconst ConnectButton: React.FC<Props> = ({ onConnect }) => {\n  const connect = React.useCallback(async () => {\n    const web3Modal = new Web3Modal({\n      network: \"rinkeby\",\n      //cacheProvider: true,\n      providerOptions: {\n        walletconnect: {\n          package: WalletConnectProvider,\n          options: {\n            rpc: rpcUrl,\n            chainId: chainId\n          }\n        }\n      }\n    });\n    try { onConnect(await web3Modal.connect()) }\n    catch (e) {\n      console.log('Web3Connect Modal Closed: ', e) // modal has closed\n    }\n  }, [onConnect])\n  return (\n    <Button size=\"lg\" color=\"primary\" onClick={connect}>\n      Connect\n    </Button>\n  )\n}\n\nexport default ConnectButton\n","import * as React from 'react'\nimport { RelayedVaultFactory } from '@rmeissner/stateless-vault-sdk';\nimport { Box, Button, createStyles, withStyles, WithStyles, Dialog, DialogContent, DialogTitle, DialogActions } from '@material-ui/core'\nimport AccountInfo from 'src/components/WalletInfo';\nimport { utils, BigNumber, providers } from 'ethers';\nimport { relayCreation, RelayEstimation, requestFee } from 'src/logic/relayRepository';\nimport { getSignerAddress, loadProvider, setLocalSigner, setAppSigner, loadSigner } from 'src/logic/ethereumRepository';\nimport ConnectButton from '../../ConnectButton';\nimport { factoryAddress, vaultImplementationAddress } from 'src/utils/config';\nimport { setLastSelectedVault, setVault } from 'src/logic/vaultRepository';\nimport { useHistory } from 'react-router';\n\nconst styles = createStyles({\n    item: {\n        display: 'block'\n    }\n})\n\ninterface Props extends WithStyles<typeof styles> {\n    open: boolean,\n    onClose: () => void\n}\n\ninterface Estimate {\n    nonce: string,\n    factory: RelayedVaultFactory,\n    address: string,\n    estimation: RelayEstimation\n}\n\nconst VaultCreationDialog: React.FC<Props> = ({ open, onClose }) => {\n    const history = useHistory()\n    const [signer, setSigner] = React.useState<string | undefined>(undefined)\n    const [estimate, setEstimate] = React.useState<Estimate | undefined>(undefined)\n    const createVault = React.useCallback(async () => {\n        if (!estimate) return\n        const localSigner = loadSigner()\n        if (!localSigner) return\n        const provider = loadProvider()\n        try {\n            const relayData = await estimate.factory.relayData(\n                localSigner, { operation: 0, ...estimate.estimation.transaction } , estimate.nonce\n            )\n            const vaultBalance = await provider.getBalance(estimate.address)\n            if (vaultBalance < BigNumber.from(estimate.estimation.fee)) throw Error(`Not enough funds to deploy to ${estimate.address} (${utils.formatEther(vaultBalance)} < ${utils.formatEther(estimate.estimation.fee)})`)\n            const deploymentTxHash = await relayCreation(relayData)\n            const deploymentTx = await provider.getTransaction(deploymentTxHash)\n            await deploymentTx.wait()\n            await setVault(estimate.address, \"My App Vault\")\n            await setLastSelectedVault(estimate.address)\n            history.push('/')\n            onClose()\n        } catch (e) {\n            console.error(e)\n        }\n    }, [onClose, history, setLastSelectedVault])\n    const estimateCreation = React.useCallback(async () => {\n        if (!signer) return\n        try {\n            const factory = new RelayedVaultFactory({\n                factoryAddress: factoryAddress,\n                vaultImplementationAddress: vaultImplementationAddress,\n                provider: loadProvider()\n            })\n            const signers = [signer]\n            const setupData = await factory.creationData({\n                signers: signers,\n                threshold: BigNumber.from(1)\n            })\n            const nonce = factory.saltNonce(\"just having lots of fun .... NOT\")\n            const address = await factory.calculateAddress(nonce, signers)\n            const estimation = await requestFee({\n                to: address,\n                value: \"0x0\",\n                data: setupData,\n                operation: 0\n            })\n            setEstimate({\n                nonce,\n                factory,\n                address,\n                estimation\n            })\n        } catch (e) {\n            console.error(e)\n        }\n    }, [signer, setEstimate])\n    React.useEffect(() => {\n        estimateCreation()\n    }, [estimateCreation])\n    const useAppAccount = React.useCallback(async () => {\n        try {\n            await setAppSigner()\n            setSigner(await getSignerAddress())\n        } catch (e) {\n            console.error(e)\n        }\n    }, [setSigner])\n    const onConnect = React.useCallback(async (web3provider: any) => {\n        try {\n            const provider = new providers.Web3Provider(web3provider)\n            setLocalSigner(provider.getSigner())\n            setSigner(await getSignerAddress())\n        } catch (e) {\n            console.error(e)\n        }\n    }, [setSigner])\n    return (\n        <Dialog\n            open={open}\n            onClose={onClose}\n            scroll=\"paper\"\n            aria-labelledby=\"scroll-dialog-title\"\n            aria-describedby=\"scroll-dialog-description\">\n            <DialogTitle id=\"scroll-dialog-title\">Confirm Transaction</DialogTitle>\n            <DialogContent dividers={true}>\n                {signer ? (\n                    <Box>\n                        Owner:<br /><AccountInfo address={signer} textColor=\"text\" />\n                        { estimate ? (<>\n                            Vault:<br /><AccountInfo address={estimate.address} textColor=\"text\" />\n                            Fee: { utils.formatEther(estimate.estimation.fee) } ETH\n                        </>) : (<>Loading...</>)}\n                    </Box>\n                ) : (\n                        <Box>\n                            <Button onClick={useAppAccount} color=\"primary\">\n                                Use App Account\n                        </Button>\n                            <ConnectButton onConnect={onConnect} />\n                        </Box>\n                    )}\n            </DialogContent>\n            <DialogActions>\n                <Button onClick={onClose} color=\"default\">\n                    Cancel\n                </Button>\n                <Button onClick={createVault} color=\"primary\" disabled={!estimate}>\n                    Confirm\n                </Button>\n            </DialogActions>\n        </Dialog>\n    )\n}\n\nexport default withStyles(styles)(VaultCreationDialog)","import * as React from 'react'\nimport WalletInfo from 'src/components/WalletInfo'\nimport { Vault } from '@rmeissner/stateless-vault-sdk';\nimport { Redirect, Route, Switch, useHistory, useParams, useRouteMatch } from \"react-router-dom\";\nimport { AppBar, BottomNavigation, BottomNavigationAction, Container, createStyles, Toolbar, WithStyles, withStyles } from '@material-ui/core';\nimport { Timeline, Settings, ArrowDropDown, Apps } from '@material-ui/icons';\nimport { getVaultInstance } from 'src/logic/vaultRepository';\nimport styled from 'styled-components'\nimport VaultTransactions from './transactions/VaultTransactions';\nimport VaultTransactionDetails from './transactions/VaultTransactionDetails';\nimport AddVaultDialog from './settings/AddVaultDialog';\nimport VaultSettings from './settings/VaultSettings';\nimport VaultSelectionDialog from './settings/VaultSelectionDialog';\nimport VaultApps from './apps/VaultApps';\nimport VaultCreationDialog from './settings/VaultCreationDialog';\n\nconst styles = createStyles({\n    title: {\n        flex: 1\n    },\n    toolbar: {\n        maxWidth: '100vw',\n        background: '#ffffff'\n    },\n    content: {\n        paddingBottom: '64px',\n        flex: \"1 1 auto\",\n        maxWidth: '100vw'\n    },\n    navigation: {\n        height: '64px',\n        position: 'fixed',\n        bottom: 0,\n        width: '100vw'\n    }\n})\n\nconst VaultHomeContainer = styled.main`\n  display: flex;\n  flex-direction: column;\n  align-items: top;\n  text-align: center;\n  flex-grow: 1;\n  width: 100vw;\n  height: 100vh;\n`\n\ninterface Active {\n    address: string,\n    instance: Vault\n}\n\ninterface Path {\n    vaultAddress: string\n}\n\nconst VaultHome: React.FC<WithStyles<typeof styles>> = ({ classes }) => {\n    const match = useRouteMatch()\n    const [active, setActive] = React.useState<Active | undefined>(undefined)\n    const [showVaultSelection, setShowVaultSelection] = React.useState(false)\n    const [showVaultCreation, setShowVaultCreation] = React.useState(false)\n    const [showAddVault, setShowAddVault] = React.useState(false)\n    const history = useHistory()\n    const { vaultAddress } = useParams<Path>()\n    React.useEffect(() => {\n        const loadActive = async () => {\n            try {\n                const instance = await getVaultInstance(vaultAddress)\n                setActive({\n                    address: vaultAddress,\n                    instance\n                })\n            } catch (e) {\n                console.log(`Could not load Vault ${vaultAddress}`)\n                console.error(e)\n                history.push(`/`)\n            }\n        }\n        loadActive()\n    }, [vaultAddress, setActive])\n    if (!active) return (<>Loading</>)\n    return (\n        <VaultHomeContainer>\n            <AppBar position=\"fixed\">\n                <Toolbar className={classes.toolbar}>\n                    <WalletInfo address={active.address!} className={classes.title} textColor=\"text\" />\n                    <ArrowDropDown color=\"action\" onClick={() => setShowVaultSelection(true)} />\n                </Toolbar>\n            </AppBar>\n            <Toolbar />\n            <Container className={classes.content}>\n                <Switch>\n                    <Route path={`${match.path}/transactions/:vaultHash`}>\n                        <VaultTransactionDetails vault={active.instance} />\n                    </Route>\n                    <Route path={`${match.path}/transactions`}>\n                        <VaultTransactions vault={active.instance} />\n                    </Route>\n                    <Route path={`${match.path}/config`}>\n                        <VaultSettings vault={active.instance} />\n                    </Route>\n                    <Route path={`${match.path}/apps`}>\n                        <VaultApps vault={active.instance} />\n                    </Route>\n                    <Route path=\"*\">\n                        <Redirect to={`${match.url}/transactions`} />\n                    </Route>\n                </Switch>\n            </Container>\n            <BottomNavigation\n                className={classes.navigation}\n                onChange={(_, newValue) => {\n                    switch (newValue) {\n                        case 1:\n                            history.push(`${match.url}/apps`)\n                            break;\n                        case 2:\n                            history.push(`${match.url}/config`)\n                            break;\n                        default:\n                            history.push(`${match.url}/transactions`)\n                            break;\n                    }\n                }}\n                showLabels\n            >\n                <BottomNavigationAction label=\"Transactions\" icon={<Timeline />} />\n                <BottomNavigationAction label=\"Apps\" icon={<Apps />} />\n                <BottomNavigationAction label=\"Settings\" icon={<Settings />} />\n            </BottomNavigation>\n            <VaultSelectionDialog open={showVaultSelection} onClose={() => setShowVaultSelection(false)} onAdd={() => setShowAddVault(true)} onCreate={() => setShowVaultCreation(true)} />\n            <VaultCreationDialog open={showVaultCreation} onClose={() => setShowVaultCreation(false)} />\n            <AddVaultDialog open={showAddVault} onClose={() => setShowAddVault(false)} />\n        </VaultHomeContainer>\n    )\n}\n\nexport default withStyles(styles)(VaultHome)","export default __webpack_public_path__ + \"static/media/yacate-logo.30ab8735.svg\";","export const undefinedOnError = async<T>(func: Promise<T>): Promise<T | undefined> => {\n    try {\n        return await func\n    } catch (e) {\n        console.error(e)\n        return undefined\n    }\n}","import AppLogo from 'src/assets/icons/yacate-logo.svg'\nimport * as React from 'react'\nimport styled from 'styled-components'\nimport { TextField } from '@material-ui/core'\nimport { utils } from 'ethers'\nimport { Button } from '@gnosis.pm/safe-react-components'\nimport { loadLastSelectedVault, loadVaults, setLastSelectedVault, setVault } from 'src/logic/vaultRepository'\nimport { useHistory } from 'react-router'\nimport { undefinedOnError } from 'src/utils/general'\nimport VaultCreationDialog from '../vault/settings/VaultCreationDialog'\n\nconst OnboardingContainer = styled.main`\n  display: flex;\n  flex-direction: column;\n  flex-grow: 1;\n  align-items: center;\n  text-align: center;\n`\n\nconst SHeading = styled.h1`\n@media screen and (max-width: 768px) {\n  font-size: 1.2em;\n}\n`\n\nconst Welcome: React.FC = () => {\n  const history = useHistory()\n  const [loading, setLoading] = React.useState(true)\n  const [vaultName, setVaultName] = React.useState(\"\")\n  const [vaultAddress, setVaultAddress] = React.useState(\"\")\n  const [inputError, setInputError] = React.useState<string | undefined>()\n  const [showVaultCreation, setShowVaultCreation] = React.useState(false)\n  const addVault = React.useCallback(async () => {\n    try {\n      const cleanAddress = utils.getAddress(vaultAddress)\n      await setVault(cleanAddress, vaultName)\n      await setLastSelectedVault(cleanAddress)\n      history.replace(`/${cleanAddress}`)\n    } catch (e) {\n      console.error(e)\n      setInputError(\"Invalid vault address\")\n    }\n  }, [setInputError, vaultAddress, vaultName, history])\n\n  const loadSelected = React.useCallback(async () => {\n    setLoading(true)\n    let selectedVault = await undefinedOnError(loadLastSelectedVault())\n    if (!selectedVault) {\n      const vaults = await loadVaults()\n      if (vaults.length > 0) {\n        selectedVault = vaults[0].address\n        await setLastSelectedVault(selectedVault)\n      }\n    }\n    if (selectedVault) {\n      history.replace(`/${selectedVault}`)\n    }\n    setLoading(false)\n  }, [history, setLoading])\n\n  React.useEffect(() => {\n    loadSelected()\n  }, [loadSelected])\n\n  if (loading) return (\n    <OnboardingContainer>\n      <img src={AppLogo} alt=\"App Logo\" width=\"100\"></img>\n      <SHeading>Yacate - A smart wallet based on the Stateless Vault</SHeading>\n      <p>Loading</p>\n    </OnboardingContainer>\n  )\n  return (\n    <OnboardingContainer>\n      <img src={AppLogo} alt=\"App Logo\" width=\"100\"></img>\n      <SHeading>Yacate - A smart wallet based on the Stateless Vault</SHeading>\n      <p>Start by adding a Vault</p>\n      <TextField\n        label=\"Vault name\"\n        onChange={(e) => {\n          setVaultName(e.target.value)\n        }}>\n        {vaultName}\n      </TextField>\n      <TextField\n        label=\"Vault address\"\n        onChange={(e) => {\n          setVaultAddress(e.target.value)\n          setInputError(undefined)\n        }}\n        error={inputError !== undefined}\n        helperText={inputError}>\n        {vaultAddress}\n      </TextField>\n      <Button size=\"lg\" color=\"primary\" onClick={addVault}>Add Vault</Button>\n      <Button size=\"lg\" color=\"secondary\" onClick={() => setShowVaultCreation(true)}>Create Vault</Button>\n      <VaultCreationDialog open={showVaultCreation} onClose={() => setShowVaultCreation(false)} />\n    </OnboardingContainer>\n  )\n}\n\nexport default Welcome","import React from 'react'\nimport { Route, Switch, HashRouter as Router } from \"react-router-dom\"\nimport VaultHome from './vault/VaultHome'\nimport Welcome from './onboarding/Welcome'\n\n\nconst App: React.FC = () => {\n  return (\n    <Router>\n      <Switch>\n        <Route path=\"/:vaultAddress\">\n          <VaultHome />\n        </Route>\n        <Route path=\"/\">\n          <Welcome />\n        </Route>\n      </Switch>\n    </Router>\n  )\n}\n\nexport default App\n","import avertaBoldFont from '@gnosis.pm/safe-react-components/dist/fonts/averta-bold.woff2'\nimport avertaFont from '@gnosis.pm/safe-react-components/dist/fonts/averta-normal.woff2'\nimport { createGlobalStyle } from 'styled-components'\nimport { normalize } from 'styled-normalize'\n\nconst GlobalStyles = createGlobalStyle`\n  ${normalize}\n\n  @font-face {\n    font-family: 'Averta';\n    font-display: swap;\n    src: local('Averta'), local('Averta Bold'),\n    url(${avertaFont}) format('woff2'),\n    url(${avertaBoldFont}) format('woff');\n  }\n\n  body {\n    font-family: 'Averta', sans-serif;\n    margin: 0;\n    padding: 0;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    width: 100vw;\n    height: 100vh;\n    background: #fefefe;\n  }\n\n  .web3connect-connect-button {\n    background-color: #008c73 !important;\n  }\n\n  .walletconnect-qrcode__base {\n    left: 0;\n  }\n\n  a {\n    color: #008c73;\n  }\n\n  .address p {\n    font-family: 'Roboto', monospace;\n  }\n`\n\nexport default GlobalStyles\n","import { theme } from '@gnosis.pm/safe-react-components'\nimport React from 'react'\nimport App from 'src/components/App'\nimport GlobalStyles from 'src/styles/global'\nimport { ThemeProvider } from 'styled-components'\n\nconst Root: React.FC = () => (\n  <React.StrictMode>\n    <ThemeProvider theme={theme}>\n      <GlobalStyles />\n      <App />\n    </ThemeProvider>\n  </React.StrictMode>\n)\n\nexport default Root\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n)\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void\n  onUpdate?: (registration: ServiceWorkerRegistration) => void\n}\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href)\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config)\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          )\n        })\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config)\n      }\n    })\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing\n        if (installingWorker == null) {\n          return\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              )\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration)\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.')\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration)\n              }\n            }\n          }\n        }\n      }\n    })\n    .catch((error) => {\n      console.error('Error during service worker registration:', error)\n    })\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type')\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload()\n          })\n        })\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config)\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      )\n    })\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then((registration) => {\n      registration.unregister()\n    })\n  }\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport Root from './Root'\nimport * as serviceWorker from './serviceWorkerRegistraction'\n\nReactDOM.render(<Root />, document.getElementById('root'))\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister()\n","import { VaultTransaction } from '@rmeissner/stateless-vault-sdk'\nimport { BigNumber, utils, } from 'ethers'\nimport { MetaTransaction } from 'src/logic/relayRepository'\nimport { multiSendAddress } from 'src/utils/config'\nimport multiSendAbi from './multisend.json'\n\nconst multiSendInterface = new utils.Interface(multiSendAbi)\n\nexport const metaTxToVaultTx = (metaTx: MetaTransaction, nonce: BigNumber, meta: any | undefined): VaultTransaction => {\n    const metaString = meta ? JSON.stringify(meta) : undefined\n    return {\n        to: metaTx.to,\n        value: metaTx.value,\n        data: metaTx.data,\n        operation: metaTx.operation || 0,\n        minAvailableGas: \"0x00\",\n        nonce: nonce.toHexString(),\n        metaHash: \"\", // Will be set by repo,\n        meta: metaString\n    }\n}\n\nconst removeHexPrefix = (input: string) => input.toLowerCase().startsWith(\"0x\") ? input.slice(2) : input;\n\nconst encodeData = function (operation: number, to: string, value: string, data: string) {\n    let dataBuffer = Buffer.from(removeHexPrefix(data), \"hex\")\n    return removeHexPrefix(utils.solidityPack(\n        [\"uint8\", \"address\", \"uint256\", \"uint256\", \"bytes\"],\n        [operation, to, BigNumber.from(value).toHexString(), dataBuffer.length, dataBuffer]\n    ))\n}\n\nexport const buildMultiSend = async (transactions: MetaTransaction[]): Promise<MetaTransaction> => {\n    if (transactions.length < 0) throw Error(\"Cannot encode empty transactions\")\n    if (transactions.length == 1) return {\n        ...transactions[0],\n        value: BigNumber.from(transactions[0].value).toHexString()\n    }\n    let multiSendBytes = \"0x\"\n    for (let transaction of transactions) {\n        multiSendBytes += encodeData(0, transaction.to, transaction.value, transaction.data)\n    }\n    const multiSendData = multiSendInterface.encodeFunctionData(\"multiSend\", [multiSendBytes])\n    return {\n        to: multiSendAddress,\n        value: \"0x00\",\n        data: multiSendData,\n        operation: 1\n    }\n}\n\n/**\n * Methods tries to decode multisend. If no multisend is detected the original transaction is returned.\n * @param transaction Meta transaction that should be decoded\n */\nexport const decodeMultiSend = async (transaction: MetaTransaction): Promise<MetaTransaction[]> => {\n    if (transaction.operation != 1) return [transaction]\n    if (transaction.to.toLowerCase() !== multiSendAddress.toLowerCase()) return [transaction]\n    if (!BigNumber.from(transaction.value).eq(BigNumber.from(0))) return [transaction]\n    try {\n        const transactions = []\n        const [multiSendBytes] = multiSendInterface.decodeFunctionData(\"multiSend\", transaction.data)\n        const rawData = removeHexPrefix(multiSendBytes)\n        let index = 0;\n        while (index < rawData.length) {\n            const operation = parseInt(rawData.slice(index, index += 2), 16)\n            const to = utils.getAddress(\"0x\" + rawData.slice(index, index += 40))\n            const value = BigNumber.from(\"0x\" + rawData.slice(index, index += 64)).toHexString()\n            const dataLength = parseInt(rawData.slice(index, index += 64), 16) * 2\n            const data = \"0x\" + rawData.slice(index, index += dataLength)\n            transactions.push({\n                to,\n                value,\n                operation,\n                data\n            })\n        }\n        return transactions\n    } catch (e) {\n        console.error(e)\n    }\n    return [transaction]\n}","import FactoryAbi from './abis/Factory.json';\nimport EIP712Domain from \"eth-typed-data\";\nimport { Contract, constants, utils, BigNumber } from 'ethers';\nimport { buildValidationData } from './utils/proof';\nimport { pullWithKeccak } from './utils/ipfs';\nimport { prepareEthSignSignatureForSafe } from './utils/signatures';\nimport StatelessVault from '@rmeissner/stateless-vault-contracts/build/contracts/StatelessVault.json';\nimport RelayedFactory from '@rmeissner/stateless-vault-contracts/build/contracts/ProxyFactoryWithInitializor2.json';\nexport { pullWithKeccak };\nexport class BaseFactory {\n    constructor() {\n        this.vaultInterface = Contract.getInterface(StatelessVault.abi);\n    }\n    async creationData(vaultSetup) {\n        return this.vaultInterface.encodeFunctionData(\"setup(address[],uint256,address,address,address)\", [vaultSetup.signers, vaultSetup.threshold, constants.AddressZero, constants.AddressZero, constants.AddressZero]);\n    }\n}\nexport class LocalVaultFactory extends BaseFactory {\n    constructor(config) {\n        super();\n        this.config = config;\n        this.factoryInstance = new Contract(config.factoryAddress, FactoryAbi, config.signer);\n    }\n    async calculateAddress(initializer, saltNonce) {\n        const initializerHash = utils.solidityKeccak256([\"bytes\"], [initializer]);\n        const salt = utils.solidityKeccak256(['bytes32', 'uint256'], [initializerHash, saltNonce]);\n        const proxyCreationCode = await this.factoryInstance.proxyCreationCode();\n        const proxyDeploymentCode = utils.solidityPack(['bytes', 'uint256'], [proxyCreationCode, this.config.vaultImplementationAddress]);\n        const proxyDeploymentCodeHash = utils.solidityKeccak256([\"bytes\"], [proxyDeploymentCode]);\n        const address = utils.solidityKeccak256(['bytes1', 'address', 'bytes32', 'bytes32'], [\"0xFF\", this.config.factoryAddress, salt, proxyDeploymentCodeHash]);\n        return \"0x\" + address.slice(-40);\n    }\n    async create(vaultSetup, saltString) {\n        const initializer = await this.creationData(vaultSetup);\n        const saltNonce = utils.keccak256(Buffer.from(saltString || `${new Date()}`));\n        try {\n            const tx = await this.factoryInstance.createProxyWithNonce(this.config.vaultImplementationAddress, initializer, saltNonce);\n            await tx.wait();\n            console.log(tx);\n        }\n        catch (e) { }\n        const address = await this.calculateAddress(initializer, saltNonce);\n        return new Vault(this.config.signer.provider, address);\n    }\n}\nexport class RelayedVaultFactory extends BaseFactory {\n    constructor(config) {\n        super();\n        this.config = config;\n        this.factoryInstance = new Contract(config.factoryAddress, RelayedFactory.abi, config.provider);\n    }\n    async calculateAddress(saltNonce, validators) {\n        return await this.factoryInstance.callStatic.calculateProxyAddress(validators, saltNonce);\n    }\n    saltNonce(saltString) {\n        return utils.keccak256(Buffer.from(saltString || `${new Date()}`));\n    }\n    async relayData(validator, setupTransaction, saltNonce) {\n        const validatorAddress = await validator.getAddress();\n        const vaultAddress = await this.calculateAddress(saltNonce, [validatorAddress]);\n        const setupHash = await this.factoryInstance.callStatic.generateSetupHash(vaultAddress, this.config.vaultImplementationAddress, setupTransaction.to, setupTransaction.value, setupTransaction.data, setupTransaction.operation, utils.solidityPack([\"address[]\"], [[validatorAddress]]));\n        const signatures = prepareEthSignSignatureForSafe(await validator.signMessage(utils.arrayify(setupHash)));\n        return {\n            implementation: this.config.vaultImplementationAddress,\n            transaction: setupTransaction,\n            validators: [validatorAddress],\n            signatures,\n            nonce: saltNonce\n        };\n    }\n}\nexport var VaultTransactionStatus;\n(function (VaultTransactionStatus) {\n    VaultTransactionStatus[VaultTransactionStatus[\"SUCCESS\"] = 0] = \"SUCCESS\";\n    VaultTransactionStatus[VaultTransactionStatus[\"FAILED\"] = 1] = \"FAILED\";\n    VaultTransactionStatus[VaultTransactionStatus[\"UNKNOWN\"] = 2] = \"UNKNOWN\";\n})(VaultTransactionStatus || (VaultTransactionStatus = {}));\nexport class Vault {\n    constructor(provider, vaultAddress) {\n        this.address = vaultAddress;\n        this.vaultInstance = new Contract(vaultAddress, StatelessVault.abi, provider);\n    }\n    async loadTransactions() {\n        const txs = [];\n        const configTopic = this.vaultInstance.interface.getEventTopic(\"Configuration\");\n        const failedTopic = this.vaultInstance.interface.getEventTopic(\"ExecutionFailure\");\n        const successTopic = this.vaultInstance.interface.getEventTopic(\"ExecutionSuccess\");\n        const events = await this.vaultInstance.queryFilter({\n            address: this.vaultInstance.address,\n            topics: [\n                [\n                    configTopic, failedTopic, successTopic\n                ]\n            ]\n        });\n        for (const e of events) {\n            if (e.topics[0] == configTopic) {\n                const config = this.vaultInstance.interface.decodeEventLog(\"Configuration\", e.data, e.topics);\n                if (config.currentNonce.eq(0)) {\n                    txs.push({\n                        action: \"config_update\",\n                        txHash: e.transactionHash\n                    });\n                }\n                else {\n                    txs.push({\n                        action: \"config_update\",\n                        txHash: e.transactionHash,\n                        nonce: config.currentNonce - 1\n                    });\n                }\n            }\n            else if (e.topics[0] == failedTopic) {\n                const exec = this.vaultInstance.interface.decodeEventLog(\"ExecutionFailure\", e.data, e.topics);\n                txs.push({\n                    action: \"executed_transaction\",\n                    vaultHash: exec.txHash,\n                    ethereumHash: e.transactionHash,\n                    nonce: exec.usedNonce,\n                    success: false\n                });\n            }\n            else if (e.topics[0] == successTopic) {\n                const exec = this.vaultInstance.interface.decodeEventLog(\"ExecutionSuccess\", e.data, e.topics);\n                txs.push({\n                    action: \"executed_transaction\",\n                    vaultHash: exec.txHash,\n                    ethereumHash: e.transactionHash,\n                    nonce: exec.usedNonce,\n                    success: true\n                });\n            }\n        }\n        return txs.reverse();\n    }\n    async loadTransactionState(vaultHash) {\n        const failedTopic = this.vaultInstance.interface.getEventTopic(\"ExecutionFailure\");\n        const successTopic = this.vaultInstance.interface.getEventTopic(\"ExecutionSuccess\");\n        const events = await this.vaultInstance.queryFilter({\n            address: this.vaultInstance.address,\n            topics: [\n                [\n                    failedTopic, successTopic\n                ],\n                null,\n                vaultHash\n            ]\n        });\n        if (events.length != 1)\n            return VaultTransactionStatus.UNKNOWN;\n        return events.length[0].topics[0] === successTopic ? VaultTransactionStatus.SUCCESS : VaultTransactionStatus.FAILED;\n    }\n    async loadConfig() {\n        const configTopic = this.vaultInstance.interface.getEventTopic(\"Configuration\");\n        const failedTopic = this.vaultInstance.interface.getEventTopic(\"ExecutionFailure\");\n        const successTopic = this.vaultInstance.interface.getEventTopic(\"ExecutionSuccess\");\n        const events = await this.vaultInstance.queryFilter({\n            address: this.vaultInstance.address,\n            topics: [\n                [\n                    configTopic, failedTopic, successTopic\n                ]\n            ]\n        });\n        const currentConfig = {\n            implementation: constants.AddressZero,\n            signatureChecker: constants.AddressZero,\n            requestGuard: constants.AddressZero,\n            fallbackHandler: constants.AddressZero,\n            signers: [],\n            threshold: BigNumber.from(0),\n            nonce: BigNumber.from(-1)\n        };\n        for (const e of events) {\n            if (e.topics[0] == configTopic) {\n                const config = this.vaultInstance.interface.decodeEventLog(\"Configuration\", e.data, e.topics);\n                if (config.currentNonce >= currentConfig.nonce) {\n                    currentConfig.signers = config.signers;\n                    currentConfig.threshold = config.threshold;\n                    currentConfig.nonce = config.currentNonce;\n                    currentConfig.implementation = config.implementation;\n                    currentConfig.signatureChecker = config.signatureChecker;\n                    currentConfig.requestGuard = config.requestGuard;\n                    currentConfig.fallbackHandler = config.fallbackHandler;\n                }\n            }\n            else if (e.topics[0] == failedTopic) {\n                const exec = this.vaultInstance.interface.decodeEventLog(\"ExecutionFailure\", e.data, e.topics);\n                if (currentConfig.nonce <= exec.usedNonce) {\n                    currentConfig.nonce = exec.usedNonce.add(1);\n                }\n            }\n            else if (e.topics[0] == successTopic) {\n                const exec = this.vaultInstance.interface.decodeEventLog(\"ExecutionSuccess\", e.data, e.topics);\n                console.log(exec);\n                if (currentConfig.nonce <= exec.usedNonce) {\n                    currentConfig.nonce = exec.usedNonce.add(1);\n                }\n            }\n            else {\n                console.warn(\"Unknown log\");\n            }\n        }\n        if (currentConfig.nonce.eq(-1))\n            throw Error(\"could not load config\");\n        return currentConfig;\n    }\n    async pullWithLoader(ipfs, key, loader, encoding) {\n        if (!loader)\n            pullWithKeccak(ipfs, key, encoding);\n        return loader(key, encoding);\n    }\n    async fetchTxByHash(ipfs, txHash, loader) {\n        const hashData = await this.pullWithLoader(ipfs, txHash, loader);\n        const tx = await this.pullWithLoader(ipfs, hashData.substring(68), loader);\n        const txData = await this.pullWithLoader(ipfs, tx.substring(3 * 64, 4 * 64), loader);\n        const to = utils.getAddress(tx.substring(64 + 24, 2 * 64));\n        const value = BigNumber.from(\"0x\" + tx.substring(2 * 64, 3 * 64));\n        const data = \"0x\" + txData;\n        const operation = parseInt(tx.substring(4 * 64, 5 * 64), 16);\n        const minAvailableGas = BigNumber.from(\"0x\" + tx.substring(5 * 64, 6 * 64));\n        const nonce = BigNumber.from(\"0x\" + tx.substring(6 * 64, 7 * 64));\n        const metaHash = \"0x\" + tx.substring(7 * 64, 8 * 64);\n        let meta;\n        if (metaHash !== \"0x0000000000000000000000000000000000000000000000000000000000000000\") {\n            try {\n                meta = await this.pullWithLoader(ipfs, metaHash, loader, \"utf8\");\n            }\n            catch (e) {\n                console.error(e);\n            }\n        }\n        return {\n            to,\n            value: value.toHexString(),\n            data,\n            operation,\n            minAvailableGas: minAvailableGas.toHexString(),\n            nonce: nonce.toHexString(),\n            metaHash,\n            meta\n        };\n    }\n    async publishTx(ipfs, to, value, dataString, operation, nonce, meta) {\n        const metaHash = meta ? utils.solidityKeccak256([\"string\"], [meta]) : \"0x\";\n        if (meta) {\n            console.log(\"Publish meta data\");\n            {\n                const res = await ipfs.add(meta, { hashAlg: \"keccak-256\" });\n                console.log(`metadata: ${res.path}`);\n            }\n        }\n        const data = utils.arrayify(dataString);\n        const vaultDomain = new EIP712Domain({\n            chainId: 4,\n            verifyingContract: this.address,\n        });\n        const VaultTx = vaultDomain.createType('Transaction', [\n            { type: \"address\", name: \"to\" },\n            { type: \"uint256\", name: \"value\" },\n            { type: \"bytes\", name: \"data\" },\n            { type: \"uint8\", name: \"operation\" },\n            { type: \"uint256\", name: \"minAvailableGas\" },\n            { type: \"uint256\", name: \"nonce\" },\n            { type: \"bytes32\", name: \"metaHash\" },\n        ]);\n        const minAvailableGas = 0;\n        const vaultTx = new VaultTx({\n            to,\n            value: value.toHexString(),\n            data,\n            operation,\n            minAvailableGas,\n            nonce: nonce.toNumber(),\n            metaHash\n        });\n        // data\n        console.log(\"Publish data\");\n        {\n            const res = await ipfs.add(data, { hashAlg: \"keccak-256\" });\n            console.log(`metadata: ${res.path}`);\n        }\n        // TX_TYPEHASH, to, value, keccak256(data), operation, minAvailableGas, nonce\n        console.log(\"Publish tx\");\n        {\n            const res = await ipfs.add(vaultTx.encodeData(), { hashAlg: \"keccak-256\" });\n            console.log(`metadata: ${res.path}`);\n        }\n        // byte(0x19), byte(0x01), domainSeparator, txHash\n        console.log(\"Publish tx hash\");\n        {\n            const res = await ipfs.add(vaultTx.encode(), { hashAlg: \"keccak-256\" });\n            console.log(`metadata: ${res.path}`);\n        }\n        const txHash = \"0x\" + vaultTx.signHash().toString('hex');\n        const dataHash = await this.vaultInstance.generateTxHash(to, value, data, operation, minAvailableGas, nonce, metaHash);\n        if (txHash != dataHash)\n            throw Error(\"Invalid hash generated\");\n        return { vaultHash: txHash, metaHash };\n    }\n    async formatSignature(config, hashProvider, signatures, signer) {\n        let sigs;\n        let signers;\n        if (signatures) {\n            const dataHash = await hashProvider();\n            sigs = signatures.map((sig) => sig.slice(2));\n            let prevIndex = -1;\n            signers = signatures.map((sig) => {\n                const signer = utils.verifyMessage(utils.arrayify(dataHash), sig);\n                const signerIndex = config.signers.indexOf(signer, prevIndex + 1);\n                if (signerIndex <= prevIndex)\n                    throw Error(\"Invalid signer\");\n                prevIndex = signerIndex;\n                return signer;\n            });\n        }\n        else if (config.signers.length == 1) {\n            const singleSigner = await signer.getAddress();\n            if (config.signers.indexOf(singleSigner) < 0)\n                throw Error(\"Signer is not an owner\");\n            sigs = [utils.solidityPack([\"uint256\", \"uint256\", \"bytes1\"], [singleSigner, 0, \"0x01\"]).slice(2)];\n            signers = [singleSigner];\n        }\n        else {\n            throw Error(\"Cannot execute transaction due to missing confirmation\");\n        }\n        return { signaturesString: \"0x\" + sigs.join(\"\"), signers };\n    }\n    async buildExecData(transaction, signatures, signer) {\n        const config = await this.loadConfig();\n        if (!config.nonce.eq(transaction.nonce))\n            throw Error(\"Invalid nonce\");\n        const { signaturesString, signers } = await this.formatSignature(config, () => {\n            return this.vaultInstance.generateTxHash(transaction.to, transaction.value, transaction.data, transaction.operation, transaction.minAvailableGas, transaction.nonce, transaction.metaHash);\n        }, signatures, signer);\n        const validationData = await buildValidationData(config, signaturesString, signers);\n        //console.log(await this.vaultInstance.callStatic.execTransaction(to, value, data, operation, 0, config.nonce, \"0x\", validationData, true))\n        return {\n            wallet: this.address,\n            validationData,\n            transaction\n        };\n    }\n}\nexport class VaultSigner {\n    constructor(vault, signer) {\n        this.vault = vault;\n        this.signer = signer;\n    }\n    async signTx(transaction) {\n        const dataHash = await this.vault.vaultInstance.generateTxHash(transaction.to, transaction.value, transaction.data, transaction.operation, transaction.minAvailableGas, transaction.nonce, transaction.metaHash);\n        return prepareEthSignSignatureForSafe(await this.signer.signMessage(utils.arrayify(dataHash)));\n    }\n    async signTxFromHash(ipfs, txHash) {\n        const vaultTx = await this.vault.fetchTxByHash(ipfs, txHash);\n        return await this.signTx(vaultTx);\n    }\n    async signUpdate(newSigners, newThreshold, nonce) {\n        const config = await this.vault.loadConfig();\n        const dataHash = await this.vault.vaultInstance.generateConfigChangeHash(config.implementation, utils.solidityPack([\"address[]\"], [newSigners]), newThreshold, config.signatureChecker, config.requestGuard, config.fallbackHandler, \"0x\", nonce, \"0x\");\n        return prepareEthSignSignatureForSafe(await this.signer.signMessage(utils.arrayify(dataHash)));\n    }\n}\nexport class VaultExecutor {\n    constructor(vault, executor) {\n        this.vault = vault;\n        this.executor = executor;\n        this.writeVaultInstance = vault.vaultInstance.connect(executor);\n    }\n    async exec(to, value, data, operation, nonce, metaHash, signatures) {\n        const transaction = { to, value: value.toHexString(), data, operation, nonce: nonce.toHexString(), minAvailableGas: \"0x0\", metaHash };\n        const execData = await this.vault.buildExecData(transaction, signatures, this.executor);\n        //console.log(await this.vaultInstance.callStatic.execTransaction(to, value, data, operation, 0, config.nonce, \"0x\", validationData, true))\n        await this.writeVaultInstance.execTransaction(execData.transaction.to, execData.transaction.value, execData.transaction.data, execData.transaction.operation, execData.transaction.minAvailableGas, execData.transaction.nonce, execData.transaction.metaHash, execData.validationData, true);\n    }\n    async update(newSigners, newThreshold, nonce, signatures) {\n        const config = await this.vault.loadConfig();\n        if (!config.nonce.eq(nonce))\n            throw Error(\"Invalid nonce\");\n        const { signaturesString, signers } = await this.vault.formatSignature(config, () => {\n            return this.vault.vaultInstance.generateConfigChangeHash(config.implementation, utils.solidityPack([\"address[]\"], [newSigners]), newThreshold, config.signatureChecker, config.requestGuard, config.fallbackHandler, \"0x\", nonce, \"0x\");\n        }, signatures, this.executor);\n        const validationData = await buildValidationData(config, signaturesString, signers);\n        await this.writeVaultInstance.updateConfig(config.implementation, newSigners, newThreshold, config.signatureChecker, config.requestGuard, config.fallbackHandler, \"0x\", nonce, \"0x\", validationData);\n    }\n}\n//# sourceMappingURL=index.js.map","export const prepareEthSignSignatureForSafe = (signature) => {\n    return signature.replace(/00$/, \"1f\").replace(/1b$/, \"1f\").replace(/01$/, \"20\").replace(/1c$/, \"20\");\n};\n//# sourceMappingURL=signatures.js.map","import CID from 'cids';\nconst removeHexPrefix = (input) => input.toLowerCase().startsWith(\"0x\") ? input.slice(2) : input;\nexport const pullWithKeccak = async (ipfs, hashPart, encoding) => {\n    const multhash = Buffer.concat([Buffer.from(\"1b20\", \"hex\"), Buffer.from(removeHexPrefix(hashPart), \"hex\")]);\n    const cid = new CID(1, \"raw\", multhash, \"base32\");\n    let out = \"\";\n    for await (const file of ipfs.get(cid.toString())) {\n        if (!file.content)\n            continue;\n        const content = [];\n        for await (const chunk of file.content) {\n            content.push(chunk);\n        }\n        out += content.map(c => c.toString(encoding || 'hex')).join();\n    }\n    return out;\n};\n//# sourceMappingURL=ipfs.js.map","import { constants, utils } from 'ethers';\nexport const buildProof = async (txSigners, allSigners) => {\n    const ownersCopy = [...allSigners];\n    const indeces = txSigners.map(signer => {\n        const i = ownersCopy.indexOf(signer);\n        ownersCopy[i] = null;\n        return i;\n    });\n    const hashes = [];\n    const nodes = allSigners.map(signer => txSigners.indexOf(signer) < 0 ? utils.solidityKeccak256([\"uint256\"], [signer]) : \"0x0\");\n    let nodesCount = nodes.length;\n    while (nodesCount > 1) {\n        for (let i = 0; i < nodesCount; i += 2) {\n            let left = nodes[i];\n            let right;\n            if (i + 1 < nodesCount) {\n                right = nodes[i + 1];\n            }\n            else {\n                right = utils.solidityKeccak256([\"uint256\"], [\"0x0\"]);\n            }\n            if (left == \"0x0\" && right == \"0x0\") {\n                nodes[Math.floor(i / 2)] = \"0x0\";\n                continue;\n            }\n            if (left == \"0x0\") {\n                hashes.push(right);\n                nodes[Math.floor(i / 2)] = \"0x0\";\n                continue;\n            }\n            if (right == \"0x0\") {\n                hashes.push(left);\n                nodes[Math.floor(i / 2)] = \"0x0\";\n                continue;\n            }\n            nodes[Math.floor(i / 2)] = utils.solidityKeccak256([\"bytes32\", \"bytes32\"], [left, right]);\n        }\n        nodesCount = Math.ceil(nodesCount / 2);\n    }\n    return { indeces, hashes };\n};\nexport const buildValidationData = async (vaultConfig, signatures, signers) => {\n    const { indeces, hashes } = await buildProof(signers, vaultConfig.signers);\n    const validationData = utils.defaultAbiCoder.encode([\"uint256\", \"uint256\", \"address\", \"address\", \"uint256[]\", \"bytes32[]\", \"bytes\"], [vaultConfig.threshold, vaultConfig.signers.length, constants.AddressZero, constants.AddressZero, indeces, hashes, signatures]);\n    return validationData;\n};\n//# sourceMappingURL=proof.js.map","import { config } from 'dotenv'\n\nconfig()\n\nexport const chainNames: { [key: number]: string; } = {\n    1: \"mainnet\",\n    4: \"rinkeby\",\n    100: \"xdai\"\n}\n\nexport const rpcUrl: string = process.env.REACT_APP_RPC_URL!!\n\nexport const chainId: number = parseInt(process.env.REACT_APP_CHAIN_ID!!)\n\nexport const chainName: string = chainNames[chainId]\n\nexport const multiSendAddress: string = process.env.REACT_APP_MULTI_SEND_ADDRESS!!\n\nexport const factoryAddress: string = process.env.REACT_APP_FACTORY_ADDRESS!!\n\nexport const vaultImplementationAddress: string = process.env.REACT_APP_VAULT_IMPLEMENTATION_ADDRESS!!\n\nexport const relayUrl: string = process.env.REACT_APP_RELAY_URL!!\n\nexport const defaultAppUrl: string = process.env.REACT_APP_DEFAULT_APP_URL!!"],"sourceRoot":""}